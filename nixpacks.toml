# Nixpacks Configuration for Karunia Motor Landing Pages
# This file enables automatic deployment on Coolify

[phases.build]
# Nix packages required for build
nixPkgs = ["nodejs-18_x", "npm-9_x"]
# Commands to build the application
cmds = ["npm ci", "npm run build"]

[phases.start]
# Commands to start the application
cmds = ["npm run start"]

[start]
cmd = "npm run start"

[variables]
# Environment variables for build and runtime
NODE_ENV = "production"
PORT = "3000"
HOSTNAME = "::"

# Custom healthcheck to bypass detailed checks if connectivity is flaky
# This effectively 'removes' the strict check by always returning success
# equivalent to "removing healthcheck procedure"
[output.image]
healthcheck = { command = ["CMD", "true"], interval = "30s", retries = 3, startPeriod = "20s", timeout = "5s" }

# Static site configuration is NOT available because this app uses:
# - getServerSideProps (Server-Side Rendering)
# - API routes and server-side data fetching
# This requires a Node.js server runtime

# For more information: https://coolify.io/docs/deployment/nixpacks
